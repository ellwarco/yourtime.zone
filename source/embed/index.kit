<!DOCTYPE html>
<html>

<head>
	<script src="/__js/all.min.js"></script>
	<title>yourtime.zone</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/manifest.json">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#f5ce7e">
	<meta name="theme-color" content="#ffffff">
	<link rel="stylesheet" type="text/css" href="../__css/embed.css" />
	<script>
		//universal embed code goes here
		var now = moment();

		function DoesEventStartWithDate(EventTime) {
			if (EventTime.diff(now, "days", true) > 1 || EventTime.diff(now, "days", true) < -1) {
				return true;
			} else {
				return false;
			}
		}

		function CheckIsEventInPast(EventTime) {
			var IsEventInPast = moment(EventTime).isBefore(now);
			return IsEventInPast;
		}
	</script>
</head>

<body onload="renderemebed()">
	<form action="/action_page.php" method="get" style="position: absolute;">
		<input id="checkboxdisplaytitle" type="checkbox" name="vehicle" onclick="renderemebed()" value="Display Title" checked>Show Title<br>
		<input id="checkboxdisplaydate" type="checkbox" name="vehicle" onclick="renderemebed()" value="Display Date" checked>Show Date<br>
	</form>
	<div id="page">
		<div id="yourtimezonewidget" class="yourtimezonewidget"></div>
	</div>
	<xmp style="display: none;" id="embedcodetemplate">
		<!-- @import "embed.js" -->
	</xmp>
	<xmp style="display: none;" id="embedcodetemplatehtml"><span><span id="INSERTEVENTID-eventname"></span> <span id="INSERTEVENTID-eventverb">starts</span><span id="INSERTEVENTID-eventpreposition"> on</span></span>
		<h1 id="INSERTEVENTID-localtime"></h1> <span>In your timezone (<span id="INSERTEVENTID-localtimezone"></span>)</span>
	</xmp>

	<xmp style="display: none;" id="embedcodetemplate2">
		<script>
			<!-- @import "embed.js" -->
		</script>
	</xmp>
	<textarea id="compiledembedcode" cols="40" rows="4" wrap="VIRTUAL" readonly="readonly">Code here</textarea>
	<script type="text/javascript">
		//generate random number one to a trillion and set it as the event ID in hex format. This done to enable the use of multiple widgets on the same page without them conflicting
		var EVENTID = (Math.round(Math.random() * 1000000000000) + 1).toString(16);
		console.log(EVENTID);

		function renderemebed() {
			var displaytitle = document.getElementById('checkboxdisplaytitle').checked;
			var displaydate = document.getElementById('checkboxdisplaydate').checked;
			var EventSerialized = "timeUTC=2017-12-12T16%3A00%3A00.000Z&Title=Time%20Mastery%20Webinar";
			var embedjs = '';

			var embedcodetemplate = document.getElementById('embedcodetemplate').innerHTML.replace(new RegExp('INSERTEVENTID', 'g'), EVENTID);
			var embedhtml = document.getElementById('embedcodetemplatehtml').innerHTML.replace(new RegExp('INSERTEVENTID', 'g'), EVENTID);

			document.getElementById("yourtimezonewidget").innerHTML = embedhtml;

			//insertcode
			console.log(embedcodetemplate);
			var head = document.getElementsByTagName('head')[0];
			var script = document.createElement('script');
			script.type = 'text/javascript';
			script.innerHTML = embedcodetemplate;
			head.appendChild(script);

			var functionrenderingthewidget = 'embed' + EVENTID + '(displaytitle, displaydate, EventSerialized)';
			console.log(functionrenderingthewidget);
			eval(functionrenderingthewidget);

			var embedcode = embedhtml + document.getElementById('embedcodetemplate2').innerHTML.replace(new RegExp('INSERTEVENTID', 'g'), EVENTID);
			document.getElementById('compiledembedcode').value = embedcode;
		}
	</script>
</body>

</html>
